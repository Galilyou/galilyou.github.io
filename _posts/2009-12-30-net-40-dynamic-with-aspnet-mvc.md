---
layout: post
title: ".NET 4.0 Dynamic with ASP.NET MVC"
date: '2009-12-30T15:38:00.000+02:00'
author: Galilyou
tags:
- asp.net mvc
- ".net"
- ".net 4.0"
- C#4.0
modified_time: '2009-12-31T09:16:29.733+02:00'
thumbnail: http://3.bp.blogspot.com/_CvP3b8RZYyc/SztaqgbrY2I/AAAAAAAAACk/HKbaG2G_RZ0/s72-c/view.png
blogger_id: tag:blogger.com,1999:blog-5568328146032664626.post-7674113031753818092
blogger_orig_url: http://www.galilyou.com/2009/12/net-40-dynamic-with-aspnet-mvc.html
---

.NET 4.0 ships with a lot of cool, new stuff. For C# the major new feature is the support of dynamic programming. The idea with dynamic support in C#, in short, is that you can statically type a variable as dynamic (yeah, this sounds funny, statically typed as dynamic, I know) in which case the compiler will not check any methods or property binding on this object, rather it will defer all of these resolutions to runtime.<br />It's not just that, but with dynamic support you can also declare your own objects to act as dynamic objects by implementing IDynamicMetaObjectProvider or -- as a shortcut -- by extending DynamicObject. Both types exist in the namespace System.Dynamic.<br />There's also a very famous type called ExpandoObject.<br />ExpandoObject is a dynamic object that you can simply create properties on it at runtime.<br />Now the trick that I want to use, is to declare my views to extend the generic System.Web.Mvc.ViewPage<dynamic>. This will allow me to pass to my view any dynamic object and access its properties through the Model property of the view.&nbsp;</dynamic><br />Here's a code example:<br /><pre class="csharp" name="code">&nbsp;using System.Dynamic;<br />&nbsp;&nbsp; &nbsp;using System.Web.Mvc;<br /><br />&nbsp;&nbsp; &nbsp;public class ArticlesController : Controller<br />&nbsp;&nbsp; &nbsp;{<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public ViewResult Index()<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dynamic x = new ExpandoObject();<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;x.Title = "Programming for Cowards";<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;x.Url = "http://galilyou.blogspot.com";<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//I even can nest<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;x.Author = new ExpandoObject();<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;x.Author.Name = "Galilyou";<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return View(x);<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}<br />&nbsp;&nbsp; &nbsp;}<br /></pre>In the above code I declare an ExpandoObject and start to set some properties on it like Title, Url, etc.<br />I do this by simply using the syntax var.Property = value; which will <i>automagically </i>create a property on the dynamically created object which type will be the type of value.<br />If you look closely you would notice that &nbsp;the Author property is an ExpandoObject itself. This nesting is allowed to as many levels as you want.<br />Here's how my view looks like:<br /><pre class="html" name="code">&lt; %@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<dynamic>" %&gt;<br /></dynamic></pre><div><br />Note, the view is declared to extend System.Web.Mvc.ViewPage<dynamic>.&nbsp;</dynamic><br /></div><div>Now you can use the values of the model like so:<br /><pre class="csharp" name="code">Model.Url<br />Model.Title<br />Model.Author.Name<br /></pre>here's how the entire view will look like: <br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_CvP3b8RZYyc/SztaqgbrY2I/AAAAAAAAACk/HKbaG2G_RZ0/s1600-h/view.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_CvP3b8RZYyc/SztaqgbrY2I/AAAAAAAAACk/HKbaG2G_RZ0/s640/view.png" /></a><br /></div>And here's the page after running the application:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_CvP3b8RZYyc/Szta0sl1MII/AAAAAAAAACs/ewxzqACj-CY/s1600-h/Untitled.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/_CvP3b8RZYyc/Szta0sl1MII/AAAAAAAAACs/ewxzqACj-CY/s640/Untitled.png" /></a><br /></div><br /><br /><b>Disclaimer:&nbsp;</b><br /><i>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;You shouldn't do this in a large scale application. View model objects are still the best tool for the &nbsp; &nbsp; &nbsp; job when the application grows. However, if you want to quirk something pretty quickly -- a small thing-- you might get away with that.</i><br /></div><div>Hope this helps.<br /></div>